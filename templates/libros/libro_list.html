{% extends "base.html" %}

{% block content %}
    <h2 class="mb-4 text-center">ğŸ“š Lista de Libros Disponibles</h2>

    <!-- Fila con BotÃ³n y Buscador -->
    <div class="row mb-4">
        {% if user.is_authenticated %}
        <div class="col-auto">
            <a class="btn btn-success" href="{% url 'libros:libro-create' %}">â• Nuevo Libro</a>
        </div>
        {% endif %}

        <div class="col">
            <form class="d-flex" method="get" action="{% url 'libros:libro-list' %}">
                <input class="form-control me-2" type="search" name="q" placeholder="Buscar libro o autor..." value="{{ q }}">
                <button class="btn btn-outline-dark" type="submit">Buscar</button>
            </form>
        </div>
    </div>

    <!-- Tabla de libros -->
    <table class="table table-striped align-middle">
        <thead class="table-dark text-center">
            <tr>
                <th>
                    <a class="text-white text-decoration-none" 
                       href="?orden=titulo&dir={% if direccion == 'asc' %}desc{% else %}asc{% endif %}{% if q %}&q={{ q }}{% endif %}">
                        ğŸ“– TÃ­tulo
                        {% if orden == "titulo" %}
                            {% if direccion == "asc" %}â¬†ï¸{% else %}â¬‡ï¸{% endif %}
                        {% endif %}
                    </a>
                </th>
                <th>
                    <a class="text-white text-decoration-none" 
                       href="?orden=autor&dir={% if direccion == 'asc' %}desc{% else %}asc{% endif %}{% if q %}&q={{ q }}{% endif %}">
                        âœï¸ Autor
                        {% if orden == "autor" %}
                            {% if direccion == "asc" %}â¬†ï¸{% else %}â¬‡ï¸{% endif %}
                        {% endif %}
                    </a>
                </th>
                <th>
                    <a class="text-white text-decoration-none" 
                       href="?orden=genero&dir={% if direccion == 'asc' %}desc{% else %}asc{% endif %}{% if q %}&q={{ q }}{% endif %}">
                        ğŸ­ GÃ©nero
                        {% if orden == "genero" %}
                            {% if direccion == "asc" %}â¬†ï¸{% else %}â¬‡ï¸{% endif %}
                        {% endif %}
                    </a>
                </th>
                <th>ğŸ“… Fecha de PublicaciÃ³n</th>
                <th>âš™ï¸ Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for libro in libros %}
            <tr>
                <td>{{ libro.titulo }}</td>
                <td>{{ libro.autor }}</td>
                <td>{{ libro.genero }}</td>
                <td class="text-center">{{ libro.fecha_publicacion|date:"d/m/Y" }}</td>
                <td class="text-center">
                    <a class="btn btn-sm btn-primary" href="{% url 'libros:libro-update' libro.id %}">âœï¸ Editar</a>
                    <a class="btn btn-sm btn-danger" href="{% url 'libros:libro-delete' libro.id %}">ğŸ—‘ï¸ Eliminar</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">No hay libros registrados</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
